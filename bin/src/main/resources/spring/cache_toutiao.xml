<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:p="http://www.springframework.org/schema/p" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
             http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
             http://www.springframework.org/schema/context
             http://www.springframework.org/schema/context/spring-context-3.0.xsd
             http://www.springframework.org/schema/util
             http://www.springframework.org/schema/util/spring-util-3.1.xsd"
	default-lazy-init="true">

    
    <!-- 分布式redis推荐数据、缓存数据、基础数据  -->
    <bean id="stringRedisTemplateToutiao" class="com.wap.sohu.recom.core.redis.StringRedisTemplateExt" >
       <property name="connectionFactory">
           <bean class="com.wap.sohu.recom.core.redis.ShardedJedisConnectionFactory" 
              p:shardedPoolConfig-ref="shardedPoolConfigToutiao"
              p:shards-ref="shardListToutiao" />        
       </property>
    </bean>	
	
	<util:list id="shardListToutiao" list-class="java.util.ArrayList">
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_toutiao1}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_toutiao1}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="toutiao1"/>
	  </bean>
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_toutiao2}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_toutiao2}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="toutiao2"/>
	  </bean>
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_toutiao3}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_toutiao3}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="toutiao3"/>
	  </bean>
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_toutiao4}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_toutiao4}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="toutiao4"/>
	  </bean>
	</util:list>
	
	
	<bean id="shardedPoolConfigToutiao" class="redis.clients.jedis.JedisPoolConfig" 
        p:maxActive="80"
        p:maxIdle="40"
        p:maxWait="60000"
        p:minIdle="7"
        p:minEvictableIdleTimeMillis="300000"
        p:timeBetweenEvictionRunsMillis="300000"
    />
    
     <!-- 分布式redis推荐数据、缓存数据、基础数据  -->
    <bean id="stringRedisTemplateMChannel" class="com.wap.sohu.recom.core.redis.StringRedisTemplateExt" >
       <property name="connectionFactory">
           <bean class="com.wap.sohu.recom.core.redis.ShardedJedisConnectionFactory" 
              p:shardedPoolConfig-ref="shardedPoolConfigMChannel"
              p:shards-ref="shardListMChannel" />        
       </property>
    </bean>	
	
	<util:list id="shardListMChannel" list-class="java.util.ArrayList">
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_mchannel1}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_mchannel1}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="mchannel1"/>
	  </bean>
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_mchannel2}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_mchannel2}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="mchannel2"/>
	  </bean>
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_mchannel3}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_mchannel3}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="mchannel3"/>
	  </bean>
	  <bean class="redis.clients.jedis.JedisShardInfo" >
	    <constructor-arg name="host" value="${recom_redis_distributed_host_mchannel4}"/>
	    <constructor-arg name="port" value="${recom_redis_distributed_port_mchannel4}"/>
	    <constructor-arg name="timeout" value="3000"/>
	    <constructor-arg name="name" value="mchannel4"/>
	  </bean>
	</util:list>
	
	
	<bean id="shardedPoolConfigMChannel" class="redis.clients.jedis.JedisPoolConfig" 
        p:maxActive="80"
        p:maxIdle="40"
        p:maxWait="60000"
        p:minIdle="7"
        p:minEvictableIdleTimeMillis="300000"
        p:timeBetweenEvictionRunsMillis="300000"
    />

</beans>